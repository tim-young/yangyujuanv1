<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge, chrome=1" />
    <meta name="description" content="description of your site" />
    <meta name="author" content="author of the site" />
    <title>IndustryApp Template</title>
    <link rel="stylesheet" href="../css/bootstrap.css" />
    <link rel="stylesheet" href="../css/bootstrap-responsive.css" />
    <link rel="stylesheet" href="http://fonts.googleapis.com/css?family=Lato:100,300,400,700,900,100italic,300italic,400italic,700italic,900italic" />
    <link rel="stylesheet" href="../css/styles.css" />
    <link rel="stylesheet" href="../css/toastr.css" />
    <link rel="stylesheet" href="../css/fullcalendar.css" />
    <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.8.3/jquery.min.js"></script>
    <script src="../js/bootstrap.js"></script>
    <script src="../js/jquery.knob.js"></script>
    <script src="http://d3js.org/d3.v3.min.js"></script>
    <script src="../js/jquery.sparkline.min.js"></script>
    <script src="../js/toastr.js"></script>
    <script src="../js/jquery.tablesorter.min.js"></script>
    <script src="../js/jquery.peity.min.js"></script>
    <script src="../js/fullcalendar.min.js"></script>
    <script src="../js/gcal.js"></script>
    <script src="../js/setup.js"></script>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" /></head>
  <body>
    <div id="in-nav">
      <div class="container">
        <div class="row">
          <div class="span12">
            <ul class="pull-right">
              <li><a href="#" id="ajaxtest">Link1</a></li>
              <li><a href="#">Link2</a></li>
              <li><a href="#">Link3</a></li>
              <li><a href="login.html">Login</a></li>
            </ul><a id="logo" href="index.html">
              <h4>杨玉娟<strong>毕业设计</strong></h4></a>
          </div>
        </div>
      </div>
    </div>
    <div id="in-sub-nav">
      <div class="container">
        <div class="row">
          <div class="span12">
            <ul>
              <li><a href="index.html"><i class="batch home"></i><br />Dashboard</a></li>
              <li><span class="label label-important pull-right">08</span><a href="stream.html"><i class="batch stream"></i><br />Stream</a></li>
              <li><span class="label label-important pull-right">04</span><a href="messages.html"><i class="batch plane"></i><br />Messages</a></li>
              <li><a href="calendar.html"><i class="batch calendar"></i><br />Calendar</a></li>
              <li><a href="paragraphs.html"><i class="batch quill"></i><br />Paragraphs</a></li>
              <li><a href="faq.html"><i class="batch forms"></i><br />FAQ</a></li>
              <li><a href="users.html" class="active"><i class="batch users"></i><br />Users</a></li>
              <li><a href="settings.html"><i class="batch settings"></i><br />Settings</a></li>
            </ul>
          </div>
        </div>
      </div>
    </div>
    <div class="page">
      <div class="page-container">
<div class="container">
  <div class="row">
    <div class="span12"><a href="#newUserModal" data-toggle="modal" class="btn pull-right">New User</a>
      <h4 class="header">Users</h4>
      <table class="table table-striped sortable">
        <thead>
          <tr>
            <th >标题</th>
            <th>来源</th>
            <th>点击量</th>
            <th>发表时间</th>
          </tr>
        </thead>
        <tbody id="ibody">
          <tr>
            <td>John</td>
            <td>Smith</td>
            <td>10</td>
            <td>2012-04-14</td>
          </tr>
          
        </tbody>
      </table>
      <div class="pagination pagination-centered">
        <ul>
          <li class="disabled"><a href="#">&laquo;</a></li>
          <li class="active"><a href="#">1</a></li>
          <li><a href="#">2</a></li>
          <li><a href="#">3</a></li>
          <li><a href="#">4</a></li>
          <li><a href="#">5</a></li>
          <li><a href="#">&raquo;</a></li>
        </ul>
      </div>
    </div>
  </div>
</div>
<div id="newUserModal" class="modal hide fade">
  <div class="modal-header">
    <button type="button" data-dismiss="modal" aria-hidden="true" class="close">&times;</button>
    <h3>New User</h3>
  </div>
  <div class="modal-body">
    <form class="form-horizontal" />
      <div class="control-group">
        <label for="inputEmail" class="control-label">Email </label>
        <div class="controls">
          <input id="inputEmail" type="text" placeholder="Email" />
        </div>
      </div>
      <div class="control-group">
        <label for="inputCurrentPassword" class="control-label">Username </label>
        <div class="controls">
          <input id="inputCurrentPassword" type="password" placeholder="Username" />
        </div>
      </div>
    </form>
  </div>
  <div class="modal-footer"><a href="#" data-dismiss="modal" class="btn">Close</a><a href="#" data-dismiss="modal" class="btn btn-primary">Save Changes</a></div>
</div>
      </div>
    </div>
    <footer>
      <div class="container">
        <div class="row">
          <div class="span12">
            <p class="pull-right">Design by boyfriend</p>
            <p>&copy; Copyright 2016  湖北大学计科12级1班杨玉娟</p>
          </div>
        </div>
      </div>
    </footer>
  </body>
  <script src="../js/d3-setup.js"></script>
  <script>
  $(function () {
	  static();
  }); 
  
  var _path = getRootPath();

  function getRootPath() {
      var strFullPath = window.document.location.href;
      var strPath = window.document.location.pathname;
      var pos = strFullPath.indexOf(strPath);
      var prePath = strFullPath.substring(0, pos);
      if (strPath.split('/').length == 3)
          return prePath;
      var postPath = strPath.substring(0, strPath.substr(1).indexOf('/') + 1);
      return (prePath + postPath);
  }
  
  function goNewsDetail(newsid){
	  var vUrl = _path + "/jsp/newslist.jsp?newsid="+newsid;
	  window.open(vUrl, "_blank");
  }
  
  function getBody(newslist){
	  var vTitle = new Array();
      vTitle[0] = "id";
      vTitle[1] = "title";
      vTitle[2] = "pubTime";
      vTitle[3] = "source";
      vTitle[4] = "bodytext";
      vTitle[5] = "visits";
      var vLen = newslist.length;
      var vBody ="";
      for(var vi=0 ; vi<vLen ; vi++){
    	  vBody +="<tr onclick=\"goNewsDetail('" + newslist[vi][vTitle[0]] + "')\"><td>"+newslist[vi][vTitle[1]]+"</td><td>"+newslist[vi][vTitle[3]]+"</td><td>"+newslist[vi][vTitle[5]]+"</td><td>"+newslist[vi][vTitle[2]]+"</td></tr>";
      }
	  return vBody ;
  }
  
  function static() {
	      $.ajax({  
	          url:'getNewsListJson.action',  
	          type:'post',  
	          data:"{}",  
	          dataType:'json',  
	          success:function (resultlist) {  
	        	  var newslist = JSON.parse(resultlist);
	        	  //alert(newslist);
	        	  //alert(resultlist);
	        	  var vbody = getBody(newslist);
	        	  $("#ibody").html(vbody);
	        	 // $("#ibody").children().remove();
	        	  //$("#ibody").append(vbody);
	          }  
	      });  
  }
  
  protocol = window.location.protocol === 'http:' ? 'ws://' : 'wss://'; 
  address = protocol + window.location.host + window.location.pathname + '/ws'; 
  socket = new WebSocket(address);
  socket.onmessage = function(msg) { msg.data == 'reload' && window.location.reload() }
  
  

</script>
</html>