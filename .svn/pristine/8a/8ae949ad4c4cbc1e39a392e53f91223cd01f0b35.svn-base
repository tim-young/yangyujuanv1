package com.yangyujuan.jdbc.dao.impl;


import java.util.ArrayList;
import java.util.List;

import org.springframework.jdbc.core.namedparam.BeanPropertySqlParameterSource;
import org.springframework.jdbc.core.namedparam.SqlParameterSource;
import org.springframework.jdbc.core.simple.ParameterizedBeanPropertyRowMapper;
import org.springframework.jdbc.core.simple.SimpleJdbcTemplate;
import org.springframework.jdbc.support.GeneratedKeyHolder;
import org.springframework.jdbc.support.KeyHolder;

import com.yangyujuan.jdbc.dao.NewsDao;
import com.yangyujuan.jdbc.dao.ProcessorDao;
import com.yangyujuan.jdbc.dao.UserDao;
import com.yangyujuan.jdbc.JdbcUtils;
import com.yangyujuan.jdbc.domain.News;
import com.yangyujuan.jdbc.domain.Processor;
import com.yangyujuan.jdbc.domain.User;

public class ProcessorDaoSpringImpl implements ProcessorDao {
	private SimpleJdbcTemplate simpleJdbcTemplate = new SimpleJdbcTemplate(
			JdbcUtils.getDataSource());

	@Override
	public void add(Processor bean) {
		String sql = "insert into Processor (sitename,domain,starturl,linkstr,bodytextstr,pubtimestr,sourcestr,titlestr) values (:sitename,:domain,:starturl,:linkstr,:bodytextstr,:pubtimestr,:sourcestr,:titlestr)";
		SqlParameterSource param = new BeanPropertySqlParameterSource(bean);
		KeyHolder keyHolder = new GeneratedKeyHolder();
		this.simpleJdbcTemplate.getNamedParameterJdbcOperations().update(sql,
				param, keyHolder);
		bean.setId(keyHolder.getKey().intValue());
	}

	@Override
	public Processor getById(int id) {
		String sql = "select id,sitename,domain,starturl,linkstr,bodytextstr,pubtimestr,sourcestr,titlestr  from Processor where id=?";
		return this.simpleJdbcTemplate.queryForObject(sql,Processor.class,id);
	}

	@Override
	public Processor getByName(String name) {
		String sql = "select id,sitename,domain,starturl,linkstr,bodytextstr,pubtimestr,sourcestr,titlestr  from Processor where sitename=?";
		return this.simpleJdbcTemplate.queryForObject(sql,Processor.class,name);
	}

	@Override
	public boolean update(Processor bean) {
		String sql = "update Processor set sitename=:sitename, domain=:domain, starturl=:starturl,linkstr=:linkstr,bodytextstr=:bodytextstr,pubtimestr=:pubtimestr,sourcestr=:sourcestr,titlestr=:titlestr where id=:id ";
		return (this.simpleJdbcTemplate.update(sql, new BeanPropertySqlParameterSource(bean))>0);
	}

	@Override
	public boolean delete(Processor bean) {
		String sql = "delete from Processor where id=?";
		//受影响的行数是否大于0
		return (this.simpleJdbcTemplate.update(sql, bean.getId())>0);
	}

	@Override
	public boolean delete(int id) {
		String sql = "delete from Processor where id=?";
		return (this.simpleJdbcTemplate.update(sql, id)>0);
	}


}
